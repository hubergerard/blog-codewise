---
layout: post
title: "Angular - Les composants"
date: 2020-11-02 17:06:20 +0100
description: "Un composant Angular, à quoi ça sert ? Et comment les utiliser correctement ?"
tags: developpement web Angular
categories: [Développement web]
author: "huber"
post_image: "/assets/img/blog/angular-composant/composants-angular.webp"
toc-text-mode: false
linked-ressource: "starter-kit-angular"
lang: fr
---

<a id="definition" class="anchor"></a>
<h2>Un composant c'est quoi ?</h2>

{% highlight ts linenos %}
@Component({
    selector: 'app-todo',
    templateUrl: './todo.component.html',  // or template: '<p>todo works!</p>',
    styleUrls: ['./todo.component.css'], // or styles: ['p { color: red }'],
    animations: [],
    encapsulation: ViewEncapsulation.Emulated,
    exportAs: 'todo'
})
export class TodoComponent  {
    @Input()
    options: any;
    @Output()
    notify: EventEmitter<string> = new EventEmitter<string>();
    todos: string[];
    constructor() { }
    addTodo(message: string) {
        this.todos.push(message);
    }
}
{% endhighlight %} 
<div class="code-caption">Exemple de composant Angular</div>

<a id="concept" class="anchor"></a>
<h3>En terme de concept</h3>

<p>Un composant (component) est une unité de découpage visuel.</p>
<p> Les pages sont des composants, elles-mêmes découpées en plusieurs composants.
    L'idée est de séparer les pages web en composants pour ne pas se contenter de découper par langage (les fameux dossiers js, html, css
    ou autre). </p>
    <p>On donne ainsi une structure logique au projet et à nos fichiers.</p>

<a id="code" class="anchor"></a>
<h3>En terme de code</h3>

<p>Un composant, c'est une classe Typescript avec des attributs, méthodes et constructeur et qui sert d'unité de
    découpage visuel dans un projet front. Il possède aussi des métadonnées qu'on lui injecte via la directive @Component.
</p>
<p>On définit un composant dans Angular par un ensemble de ressources :</p>

<ul>
    <li>une portion de HTML</li>
    <li>une ou des feuilles de styles associée(s) à ce HTML</li>
    <li>une classe TypeScript ou JavaScript</li>
</ul>

<p>Pour l'instancier, on utilise son sélecteur qui correspond à un tag HTML. Vous pouvez donc intégrer votre
    composant directement dans un bloc HTML, en utilisant son tag HTML associé.</p>

<p>Un composant est réutilisable autant de fois que nécessaire. Par conséquent, on ne code un composant qu'une
    fois pour plusieurs affichages.</p>

<p>On a également accès à son cycle de vie, via des hooks et il peut posséder n entrée/sortie pour communiquer avec d'autres composants.</p>

<a id="selector-component" class="anchor"></a>
<h2>Sélecteur de composant</h2>

<p>
    Tout les composants angular disposent d'un sélecteur CSS qui déterminera la déclaration du composant dans le HTML (tag) :
</p>

{% highlight ts linenos %}
@Component({
    selector: 'component-home',
    ...
  })
  export class ComponentHeader { }
{% endhighlight %} 
<div class="code-caption">Exemple de composant Angular</div>

<p>
    Pour appeler ce composant à un endroit de votre HTML faites ceci :
</p>

{% highlight ts linenos %}
@Component({
    template: `
      <component-home />
      <button>Nous contacter</button>`,
    ...,
  })
  export class ComponentHome { }
{% endhighlight %} 
<div class="code-caption">Déclaration de composant Angular</div>

<p>
    La plupart des composants devraient être identifiés par un nom d'élément personnalisé servant de sélecteur. Il est impératif que tous les noms d'éléments personnalisés comportent un trait d'union, conformément aux directives de la spécification HTML.
</p>

<p>
    De manière standard, Angular génère une erreur lorsqu'il détecte un nom de balise personnalisé ne correspondant à aucun composant connu, évitant ainsi les erreurs provoquées par des fautes de frappe dans les noms de composants.
</p>

<a id="selector-prefix" class="anchor"></a>
<h3>Préfixes de sélecteur</h3>

<p>
    L'équipe Angular suggère d'adopter un préfixe uniforme et concis pour tous les composants personnalisés de votre projet.
</p>

<p>
    Si, par exemple, vous développiez YouTube en utilisant Angular, vous pourriez débuter le nom de vos composants par "yt-", donnant lieu à des composants tels que yt-menu, yt-player, etc.
</p>

<p>
    Par défaut, le préfixe utilisé par l'interface en ligne de commande d'Angular est "app-".
</p>

<a id="lifecycle" class="anchor"></a>
<h2>Cycle de vie d'un composant</h2>

<div class="row">
    <figure class="text-center wp-block-image size-large">
        <img src="/assets/img/blog/angular-composant/Les-composants1.jpg"
            alt="Cycle de vie d'un composant Angular" class="wp-image-961" width="600px" />
    </figure>
</div>


<p>Angular vous permet d'exécuter du Javascript lors de certains évènements liés au cycle de vie du component.
</p>

<p>Cela peut s'avérer utile, par exemple pour lancer un appel API au chargement d'une page ou bien pour
    supprimer une ressource lors de la destruction de l'instance du composant.</p>

<div class="quote-block">
    <i class="fa fa-info-circle quote-icon" aria-hidden="true"></i>
    <div class="quote">
      Référez vous à notre article sur <a href="/angular-composant-cycle-de-vie" target="_blank"> Les cycles de vie d'un composant</a>
    </div>
</div>

<h3>ngOnChange</h3>

<ul>
    <li>ne s’exécute pas si pas d’@Input</li>
    <li>1er hook appelé après l’appel au constructeur</li>
    <li>déclenché à chaque changement de donnée en entrée <code>@Input</code></li>
</ul>

<h3>ngOnInit</h3>

<ul>
    <li>intervient après l’appel de ngOnChange()&nbsp;</li>
    <li>déclenché après l’initialisation du composant</li>
    <li>appelé uniquement une fois</li>
</ul>

<h3>ngDoCheck</h3>

<ul>
    <li>intervient après l’appel de ngOnInit()&nbsp;</li>
    <li> ne s’exécute pas si ngOnChange est implémentée</li>
</ul>

<h3>ngAfterContentInit</h3>

<ul>
    <li>s'exécute lorsqu’un content (ng-content) est initialisé</li>
    <li>@ContentChildren et @ContentChild sont valorisées</li>
</ul>

<h3> ngAfterContentChecked </h3>

<ul>
    <li>exécuté à chaque détection de changement</li>
    <li>@ContentChildren et @ContentChild sont valorisées </li>
</ul>

<h3> ngAfterViewInit </h3>

<ul>
    <li>exécuté une fois les vues enfants initialisé</li>
</ul>

<h3> ngAfterViewChecked </h3>

<ul>
    <li>exécuté à chaque détection de changement</li>
    <li>@ViewChildren et @ViewChild sont valorisées</li>
</ul>

<h3> ngOnDestroy </h3>

<ul>
    <li>exécuté avant la <a href="/angular-supprimer-composant" target="_blank">suppression du composant</a></li>
</ul>

<div class="quote-block">
    <i class="fa fa-info-circle quote-icon" aria-hidden="true"></i>
    <div class="quote">
        La prochaine étape, quand vous êtes à l'aise avec le concept de composants : <a href="/angular-services-introduction">Les services Angular</a>.
    </div>
</div>

<a id="more-information" class="anchor"></a>
<h2>Sources</h2>
<ul>
    <li>Guide officiel d'Angular sur les composants : <a href="https://angular.io/guide/architecture-components" target="_blank">Angular - Introduction to components and templates</a></li>
    <li>Cycle de vie des composants : <a href="https://angular.io/guide/lifecycle-hooks" target="_blank">Angular - Hooking into the component lifecycle</a></li>
    <li>Anatomie des composants : <a href="https://angular.dev/guide/components" target="_blank">Angular.Dev</a></li>
</ul>